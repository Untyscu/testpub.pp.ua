window.onload=(()=>{let e=document.getElementById("board"),t=document.getElementById("panel"),n=document.getElementById("start"),l=document.getElementById("result"),i=document.getElementById("clock"),o={line:7,column:7,elements:[],timeout:10};function c(e,t,n,l){this.x=e,this.y=t,this.label=n,this.id=l}let d=["pomegranate","nephritis","belizehole","orange","turquoise","wisteria","midnightblue","pumpkin"],a=[],u=0,r=o.timeout,s=!1;function m(n){e.innerHTML="";let l=0;for(var i=0;i<o.line;i++){let t=document.createElement("div");t.className="row",t.id="row"+i,e.appendChild(t);for(var c=0;c<o.column;c++){let e=document.createElement("div");e.className="column "+n[l].label,e.dataset.id=n[l].id,e.addEventListener("click",function(){f(e.dataset.id)}),document.getElementById("row"+i).appendChild(e),l++}}t.innerText=u}function f(e){a=[];let t=function(e){let t;return o.elements.forEach(function(n){n.id==e&&(t=n)}),t}(e);!function e(t,n){a.push(t.id),t.x>0&&n.filter(function(n){n.x==t.x-1&&n.y==t.y&&n.label==t.label&&(a.includes(n.id)||e(n,o.elements))}),t.x<o.column-1&&n.filter(function(n){n.x==t.x+1&&n.y==t.y&&n.label==t.label&&(a.includes(n.id)||e(n,o.elements))}),t.y>0&&n.filter(function(n){n.x==t.x&&n.y==t.y-1&&n.label==t.label&&(a.includes(n.id)||e(n,o.elements))}),t.y<o.line-1&&n.filter(function(n){n.x==t.x&&n.y==t.y+1&&n.label==t.label&&(a.includes(n.id)||e(n,o.elements))})}(t,o.elements),console.log(a.length),a.length>1&&(!function(e,t){let n=[];d.forEach(e=>{if(e!=t)return n.push(e)}),console.log(n),console.log(t),o.elements.forEach(function(t){e.includes(t.id)&&(t.label=n[Math.floor(7*Math.random())])})}(a,t.label),u+=a.length,r=o.timeout,m(o.elements))}let h=()=>{setInterval(function(){r<=0?(e.style.display="none",l.innerHTML="Your points: "+u+"<br>Your rating: in developing",clearInterval(h)):(i.innerText=r-1,r--)},1e3)};n.addEventListener("click",function(){!function(){o.elements=[];for(let e=0;e<o.line;e++)for(let t=0;t<o.column;t++)o.elements.push(new c(e,t,d[Math.floor(8*Math.random())],e.toString()+t.toString()))}(),u=0,l.innerText="",e.style.display="block",r=o.timeout,s?r=o.timeout:(h(),s=!0),m(o.elements)})});